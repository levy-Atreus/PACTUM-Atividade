name: CI e Publica莽茫o de Resultados

on:
  push:
    # Ajuste os branches conforme necess谩rio para o seu novo reposit贸rio Pactum
    branches: [ "main", "exercicios/modulo-4" ] 
  workflow_dispatch:

jobs:
  test_and_publish: 
    runs-on: ubuntu-latest
    
    permissions:
      contents: write 
      pages: write
      id-token: write

    steps:
    - name: 猬锔 Checkout do C贸digo
      uses: actions/checkout@v4

    - name: 锔 Configurar Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20' 
        
    - name:  Instalar Depend锚ncias
      run: npm install

    #  PARTE CRTICA CORRIGIDA: Usa o script do Pactum/Mocha
    - name: И Rodar Testes (Serverest + Pactum) 
      # CORREO AQUI: Chama o script 'test:ci' (que 茅 o nome correto para o Pactum/Mocha)
      run: npm run test:ci 
      # N茫o precisa de continue-on-error, pois o job deve falhar se os testes falharem

    # 4. Publica莽茫o do Relat贸rio (Ajustado para relat贸rios Pactum, se houver)
    - name: 猬锔 Publicar Relat贸rio de Testes
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        # Depende do seu framework Pactum/Mocha.
        # Se voc锚 n茫o tem um relat贸rio HTML sendo gerado, voc锚 pode APAGAR esta etapa 4.
        # Se voc锚 usar o Mochawesome no Pactum, o caminho pode ser diferente (ex: ./reports)
        publish_dir: ./reports # Exemplo de diret贸rio de relat贸rio para Mocha/Pactum
        publish_branch: gh-pages